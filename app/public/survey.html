<!DOCTYPE html>

<html lang="en-us">

<head>

  <meta charset="UTF-8">
  <title>Friend Finder</title>


    
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css?family=Abril+Fatface|Dosis:400,600,700,800|Montserrat:400,500|Raleway:400,500"
      rel="stylesheet">

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <link href="public/css/style.css" rel="stylesheet" type="text/css">

  <style>
      .home {
    font-size: 20px;
}

.survey-btn {
    margin-top: 20px;
    margin-bottom: -10px;
}

.jumbotron {
    margin-top: 10px;
}

.underline {
    border-bottom: 1px solid rgba(0, 0, 0, .1);
    padding-bottom: 20px;
}

#survey-header {
    margin-top: 15px;
    font-weight: 400;
}

.survey-question-head {
    font-size: 28px;
    font-weight: bold;
    margin-top: 10px;
}

.question {
    font-size: 18px;
}

#submit {
    margin-top: 20px;
    margin-bottom: 30px;
}

.bottom-menu {
    margin-bottom: 50px;
}
  </style>
  
</head>
<body>
<div class="container">

    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content mainModal">
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
                    <h1 class="modal-title resultName" id="friendName"></h1>
                </div>
                <div class="modal-body resultImgDiv" id="friendImg">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <h1 id="survey-header" class="underline">Survey Questions</h1>


    <p class="survey-question-head">About You</p>

    <form class="underline">
        <div class="form-group">
          <label for="exampleInputEmail1">Name (required)</label>
          <input type="text" class="form-control" id="user-name" required>
        </div>
        <div class="form-group">
          <label for="exampleInputPassword1">Link to Photo Image (required)</label>
          <input type="text" class="form-control" id="image-src" required>
        </div>
      </form>

    



    <p class="survey-question-head">Question 1</p>

    <p class="question">Your mind is always buzzing with unexplored ideas and plans.</p>

    <select class="chosen-select" id="q1">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>


    <p class="survey-question-head">Question 2</p>

    <p class="question">Generally speaking, you rely more on your experience than your imagination.</p>

    <select class="chosen-select" id="q2">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>

    <p class="survey-question-head">Question 3</p>

    <p class="question">You find it easy to stay relaxed and focused even when there is some pressure.</p>

    <select class="chosen-select" id="q3">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>


    <p class="survey-question-head">Question 4</p>

    <p class="question">You rarely do something just out of sheer curiosity.</p>

    <select class="chosen-select" id="q4">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>

    <p class="survey-question-head">Question 5</p>

    <p class="question">People can rarely upset you.</p>

    <select class="chosen-select" id="q5">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>


    <p class="survey-question-head">Question 6</p>

    <p class="question">It is often difficult for you to relate to other people’s feelings.</p>

    <select class="chosen-select" id="q6">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>


    <p class="survey-question-head">Question 7</p>

    <p class="question">In a discussion, truth should be more important than people’s sensitivities.</p>

    <select class="chosen-select" id="q7">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>

    <p class="survey-question-head">Question 8</p>

    <p class="question">You rarely get carried away by fantasies and ideas.</p>

    <select class="chosen-select" id="q8">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>


    <p class="survey-question-head">Question 9</p>

    <p class="question">You think that everyone’s views should be respected regardless of whether they are supported by facts or not.
    </p>

    <select class="chosen-select" id="q9">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>

    <p class="survey-question-head">Question 10</p>

    <p class="question">You feel more energetic after spending time with a group of people.</p>

    <select class="chosen-select" id="q10">
        <option value></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
    </select>

    <button  type="submit" class="btn btn-primary btn-lg btn-block" id="submit">Submit</button>

    <hr>

    <div class="bottom-menu">
    <a href="/api/friends">API Friends List</a> | <a href="https://github.com/KingLard/friend_finder">Github Repo</a>
    </div>


</div>




</body>

</html>



<script type="text/javascript">



$("#submit").on("click", function (event) {
            event.preventDefault();
            // create a varieble for validation
            var formValid = true;
            // checking if form filled
            if ($("#user-name").val().trim() === "" || $("#image-src").val().trim() === "") {
                formValid = false;
            }

            for (var i = 1; i < 10; i++) {
                if ($("#question" + i).val() === "") {
                    formValid = false;
                }
            }
            // if the form is filled correctly grab the data and run ajax request
            if (formValid === true) {
                var user = {
                    "name": $("#user-name").val().trim(),
                    "photo": $("#image-src").val().trim(),
                    "scores": [$("#q1").val().trim(), $("#q2").val().trim(), $("#q3").val().trim(), $("#q4").val().trim(), $("#q5").val().trim(), $("#q6").val().trim(), $("#q7").val().trim(), $("#q8").val().trim(), $("#q9").val().trim(), $("#q10").val().trim()]
                }
                // console.log(user.scores)
                // get data from the API and then run the logic of the game (pick the right match)
                $.ajax({ url: "/api/friends", method: "GET" })
                    .then(function (friends) {
                        var newArray = [];
                        var resultArray = [];
                        var arrayTotal
                        // function to compare user's answers with the "friends" object from the API
                        function compareResults(x) {
                            for (var i = 0; i < friends[0].scores.length; i++) {
                                var diffArray = user.scores[i] - friends[x].scores[i];
                                newArray.push(Math.abs(diffArray));
                                // console.log(newArray)
                            }
                            // function to add all the results inside "diffArray"
                            function getSum(total, num) {
                                return total + num;
                            }
                            var arrayTotal = newArray.reduce(getSum);
                            // push the result to a new array "resultArray"
                            resultArray.push(arrayTotal)
                            newArray = [];
                        }
                        // run this loop to call the "compareResults" function and run it for each of the elements in the "friend" Array.
                        for (var j = 0; j < friends.length; j++) {
                            compareResults(j);
                        }
                        // console.log(resultArray);

                        // grab the lowest number from the resultArray
                        var lowestNumber = Math.min(...resultArray)
                        // find the Index within the Array to find the match
                        var chosen = resultArray.indexOf(lowestNumber)

                        // console.log(friendsData[chosen].name);

                        // print result to the Modal
                        $("#friendName").text("Your Match is: " + friends[chosen].name)
                        $("#friendImg").html("<img class='resultImage' src='" + friends[chosen].photo + "' style='width:400px; height:400px;' alt='Match Picture'>")
                        // trigger modal to pop up
                        $("#myModal").modal("show");

                    }).then(function () {
                        // post the results to the API AFTER finding the match
                        var currentURL = window.location.origin;
                        $.post(currentURL + "/api/friends", user, function (data) {
                            // if (data) {
                            //     alert("Yay! There is a match!");
                            // }
                            $("#inputName").val("");
                            $("#inputPhoto").val("");
                        });
                    })

            } else {
                // if validation is false (missing answers), alert this message
                alert("Please fill out all fields before submitting!")
            }
        })

 








</script>



